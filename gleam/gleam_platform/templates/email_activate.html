{% extends "base_message.html" %}

{% block title %} | 邮箱验证{% endblock title %}

{% block content %}
<div class="container">
  <div class="row">
    <div class="col-md-8 col-md-offset-2" style="text-align: center;">
      <h1>一封验证邮件已经发送到您的邮箱</h1>
      <h1>请点击邮件中提供的链接完成注册</h1>
      <a id="link_resend" href="{{ domain }}{% url 'confirmation-email-send' user_id %}">
        <button id="button_resend" class="btn btn-success">重发该邮件(60s内只能发送一次)</button>
      </a>
      <div class="space"></div>
    </div>
  </div>
</div>
{% endblock content %}

{% block javascripts %}
{{ block.super }}
<script>
    function change(){
        $("#button_resend").attr("class","btn btn-success");
        $("#link_resend").attr("href","{{ domain }}{% url 'confirmation-email-send' user_id %}");
        $("#button_resend").html("重发该邮件(60s内只能发送一次)");
    }
    $(document).ready(function() {
        $("#button_resend").click(function () {
            $.ajax({
                type: "POST",
                dataType: "text",
                url: "confirmation_email_resend",
                data: "request.user.id",
                success: function (){

                }
            });
            $('#link_resend>#button_resend').trigger('click')
            $("#button_resend").attr("class","btn btn-disabled");
            $("#button_resend").html("已发送(60s内只能发送一次)");
            $("#link_resend").removeAttr("href");
            var t=setTimeout("change()" ,2000);
        });
    });
</script>
<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.3.2.min.js"type="text/javascript"></script>
{% endblock javascripts %}